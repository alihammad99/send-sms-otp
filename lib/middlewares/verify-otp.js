exports.__esModule=!0,exports.verifyOTPCode=void 0;var _error=_interopRequireDefault(require("../utils/error.js")),_saveOtp=require("./save-otp.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const verifyOTPCode=function(e,r,t){const o=_saveOtp.saveOTP.get(e);return o&&Number(o.otp)===Number(r)?Date.now()>o.expiresAt?((0,_error.default)("OTP code has expired",t,"warn"),_saveOtp.saveOTP.delete(e),!1):(_saveOtp.saveOTP.delete(e),(0,_error.default)("OTP verified!",t),!0):((0,_error.default)("Failed! Incorrect OTP code",t,"error"),!1)};exports.verifyOTPCode=verifyOTPCode;